<Project>

  <Target Name="CreateOneDasMetaData" BeforeTargets="BeforeBuild">

    <!-- validation -->
    <Error Condition="$(Major) == ''" Text="The Major property must be set." />
    <Error Condition="$(Minor) == ''" Text="The Minor property must be set." />
    <Error Condition="$(Revision) == ''" Text="The Revision property must be set." />
    <Error Condition="$(PackageLicenseUrl) == ''" Text="The PackageLicenseUrl property must be set." />
    <Error Condition="$(PackageProjectUrl) == ''" Text="The PackageProjectUrl property must be set." />

    <!-- build properties -->
    <PropertyGroup>

      <!-- ensure default values -->
      <Authors Condition="$(Authors) == '' OR $(Authors) == $(PackageId)">https://github.com/OneDAS-Group</Authors>
      <Company Condition="$(Company) == '' OR $(Authors) == $(PackageId)">https://github.com/OneDAS-Group</Company>
      <Copyright Condition="$(Copyright) == ''">OneDAS Group</Copyright>

      <!-- create new properties -->
      <AssemblyVersion>$(Major).0.0.0</AssemblyVersion>
      <FileVersion>$(Major).$(Minor).$(Revision)</FileVersion>
      <Product>OneDAS</Product>
      <RepositoryUrl>$(PackageProjectUrl)</RepositoryUrl>
      <Version>$(Major).$(Minor).$(Revision)</Version>

      <Build Condition="$(IsFinalBuild) == 'True'">final</Build>
      
    </PropertyGroup>

    <!-- build Version -->
    <PropertyGroup Condition="$(VersionSuffix) != '' AND $(Build) != ''">
      <Version>$(Version)-$(VersionSuffix)-$(Build)</Version>
      <FileVersion>$(Major).$(Minor).$(Revision).$(Build)</FileVersion>
    </PropertyGroup>

    <PropertyGroup Condition="$(VersionSuffix) != '' AND $(Build) == ''">
      <Version>$(Version)-$(VersionSuffix)</Version>
      <FileVersion>$(Major).$(Minor).$(Revision).0</FileVersion>
    </PropertyGroup>

    <!-- build PackageVersion -->
    <PropertyGroup>
      <PackageVersion>$(Version)</PackageVersion>
    </PropertyGroup>

  </Target>
  
</Project>